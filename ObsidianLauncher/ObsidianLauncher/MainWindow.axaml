<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:loc="clr-namespace:ObsidianLauncher.Localization"
        x:Class="ObsidianLauncher.MainWindow"
        Icon="/Assets/Obsidian.ico"
        Title="Obsidian Launcher"
        Width="950"
        Height="740"
        WindowStartupLocation="CenterScreen"
        Background="{Binding WindowBackground}"
        Foreground="{Binding TextPrimary}">

	<Window.Styles>
		<Style Selector="Button.primary">
			<Setter Property="Background" Value="#8B5CF6" />
			<Setter Property="Foreground" Value="White" />
			<Setter Property="BorderThickness" Value="0" />
			<Setter Property="CornerRadius" Value="6" />
			<Setter Property="Padding" Value="32,14" />
			<Setter Property="FontSize" Value="13" />
			<Setter Property="FontWeight" Value="SemiBold" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="HorizontalContentAlignment" Value="Center" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
		</Style>

		<Style Selector="Button.primary:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#A78BFA" />
		</Style>

		<Style Selector="Button.primary:pressed /template/ ContentPresenter">
			<Setter Property="Background" Value="#7C3AED" />
		</Style>

		<Style Selector="Button.primary:disabled /template/ ContentPresenter">
			<Setter Property="Background" Value="#6B7280" />
			<Setter Property="Opacity" Value="0.5" />
		</Style>

		<Style Selector="Button.secondary">
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="BorderThickness" Value="2" />
			<Setter Property="BorderBrush" Value="#8B5CF6" />
			<Setter Property="CornerRadius" Value="6" />
			<Setter Property="Padding" Value="32,14" />
			<Setter Property="FontSize" Value="13" />
			<Setter Property="FontWeight" Value="SemiBold" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="HorizontalContentAlignment" Value="Center" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
		</Style>

		<Style Selector="Button.secondary:pointerover">
			<Setter Property="Background" Value="#8B5CF620" />
		</Style>

		<Style Selector="Button.theme-toggle">
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="BorderThickness" Value="2" />
			<Setter Property="BorderBrush" Value="#8B5CF6" />
			<Setter Property="CornerRadius" Value="4" />
			<Setter Property="Padding" Value="14,8" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="FontSize" Value="11" />
			<Setter Property="FontWeight" Value="SemiBold" />
			<Setter Property="HorizontalContentAlignment" Value="Center" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
		</Style>

		<Style Selector="Button.theme-toggle:pointerover">
			<Setter Property="Background" Value="#8B5CF620" />
		</Style>

		<Style Selector="Button.hamburger">
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="BorderThickness" Value="0" />
			<Setter Property="CornerRadius" Value="0" />
			<Setter Property="Padding" Value="12" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="Width" Value="48" />
			<Setter Property="Height" Value="48" />
			<Setter Property="HorizontalContentAlignment" Value="Center" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
		</Style>

		<Style Selector="Button.hamburger:pointerover">
			<Setter Property="Background" Value="#8B5CF620" />
		</Style>

		<Style Selector="Button.update-button">
			<Setter Property="Background" Value="#10B981" />
			<Setter Property="Foreground" Value="White" />
			<Setter Property="BorderThickness" Value="0" />
			<Setter Property="CornerRadius" Value="6" />
			<Setter Property="Padding" Value="20,12" />
			<Setter Property="FontSize" Value="12" />
			<Setter Property="FontWeight" Value="SemiBold" />
			<Setter Property="Cursor" Value="Hand" />
			<Setter Property="HorizontalContentAlignment" Value="Center" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
		</Style>

		<Style Selector="Button.update-button:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#34D399" />
		</Style>

		<Style Selector="TextBox">
			<Setter Property="CornerRadius" Value="4" />
			<Setter Property="Padding" Value="12,10" />
			<Setter Property="FontSize" Value="13" />
			<Setter Property="BorderThickness" Value="1" />
		</Style>

		<Style Selector="ComboBox">
			<Setter Property="CornerRadius" Value="4" />
			<Setter Property="Padding" Value="12,10" />
			<Setter Property="FontSize" Value="13" />
		</Style>

		<Style Selector="ProgressBar">
			<Setter Property="Height" Value="4" />
			<Setter Property="CornerRadius" Value="2" />
			<Setter Property="Foreground" Value="#8B5CF6" />
		</Style>

		<Style Selector="ProgressBar /template/ Border#PART_Indicator">
			<Setter Property="CornerRadius" Value="2" />
		</Style>
	</Window.Styles>

	<Grid>
		<!-- Main Content -->
		<Grid IsVisible="{Binding !IsMenuOpen}">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
				<RowDefinition Height="Auto" />
			</Grid.RowDefinitions>

			<!-- Header Bar -->
			<Border Grid.Row="0"
			       Background="{Binding CardBackground}"
			       BorderBrush="{Binding BorderColor}"
			       BorderThickness="0,0,0,1"
			       Height="60">
				<Grid Margin="20,0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="Auto" />
					</Grid.ColumnDefinitions>

					<Button Grid.Column="0"
					       Classes="hamburger"
					       Command="{Binding ToggleMenuCommand}"
					       VerticalAlignment="Center"
					       ToolTip.Tip="{loc:Localize Settings}">
						<TextBlock Text="☰" FontSize="22" Foreground="{Binding TextPrimary}" />
					</Button>

					<TextBlock Grid.Column="1"
					          Text="{loc:Localize AppTitle}"
					          FontSize="16"
					          FontWeight="Bold"
					          Foreground="{Binding TextPrimary}"
					          HorizontalAlignment="Center"
					          VerticalAlignment="Center"
					          LetterSpacing="2" />

					<Button Grid.Column="2"
					       Classes="theme-toggle"
					       Command="{Binding ToggleThemeCommand}"
					       VerticalAlignment="Center"
					       Content="{Binding ThemeButtonText}"
					       Foreground="{Binding TextPrimary}"
					       ToolTip.Tip="Toggle Theme" />
				</Grid>
			</Border>

			<!-- Main Content Area -->
			<Grid Grid.Row="1" Margin="80,50">
				<Border Background="{Binding CardBackground}"
				       BorderBrush="{Binding BorderColor}"
				       BorderThickness="1"
				       CornerRadius="12"
				       Padding="50"
				       VerticalAlignment="Center"
				       BoxShadow="0 4 20 0 #10000000">

					<StackPanel VerticalAlignment="Center" Spacing="32">

						<!-- Update Available Button -->
						<Button Classes="update-button"
						       Content="{loc:Localize LauncherUpdateAvailable}"
						       Command="{Binding UpdateLauncherCommand}"
						       HorizontalAlignment="Center"
						       IsVisible="{Binding IsLauncherUpdateAvailable}" />

						<!-- Action Buttons -->
						<StackPanel Orientation="Horizontal"
						           HorizontalAlignment="Center"
						           Spacing="20">
							<Button Classes="primary"
							       Content="{loc:Localize InstallUpdate}"
							       Command="{Binding InstallCommand}"
							       IsEnabled="{Binding InstallEnabled}"
							       Width="220" />

							<Button Classes="secondary"
							       Content="{loc:Localize Launch}"
							       Command="{Binding LaunchCommand}"
							       Foreground="{Binding TextPrimary}"
							       Width="220" />
						</StackPanel>

						<!-- Progress Section -->
						<StackPanel Spacing="16"
						           IsVisible="{Binding IsDownloading}"
						           MinWidth="500">
							<TextBlock Text="{Binding StatusText}"
							          FontSize="14"
							          FontWeight="SemiBold"
							          Foreground="{Binding TextPrimary}"
							          HorizontalAlignment="Center" />

							<ProgressBar Value="{Binding DownloadProgress}"
							            Maximum="100"
							            Foreground="#8B5CF6"
							            Background="{Binding ProgressBackground}" />

							<TextBlock Text="{Binding ProgressText}"
							          FontSize="12"
							          Foreground="{Binding TextSecondary}"
							          HorizontalAlignment="Center" />
						</StackPanel>

						<!-- Status Message (when not downloading) -->
						<Border IsVisible="{Binding !IsDownloading}"
						       Background="{Binding InputBackground}"
						       BorderBrush="{Binding BorderColor}"
						       BorderThickness="1"
						       CornerRadius="6"
						       Padding="24,16"
						       HorizontalAlignment="Center">
							<TextBlock Text="{Binding StatusText}"
							          FontSize="14"
							          FontWeight="SemiBold"
							          Foreground="{Binding TextPrimary}"
							          HorizontalAlignment="Center" />
						</Border>
					</StackPanel>
				</Border>
			</Grid>

			<!-- Footer -->
			<Border Grid.Row="2"
			       Background="{Binding CardBackground}"
			       BorderBrush="{Binding BorderColor}"
			       BorderThickness="0,1,0,0"
			       Height="50">
				<Grid Margin="20,0">
					<TextBlock Text="{loc:Localize Copyright}"
					          FontSize="10"
					          Foreground="{Binding TextSecondary}"
					          VerticalAlignment="Center"
					          HorizontalAlignment="Left" />
					<TextBlock Text="{Binding CurrentVersion}"
					          FontSize="10"
					          Foreground="{Binding TextSecondary}"
					          VerticalAlignment="Center"
					          HorizontalAlignment="Right" />
				</Grid>
			</Border>
		</Grid>

		<!-- Settings Menu Overlay -->
		<Border Background="#80000000"
		       IsVisible="{Binding IsMenuOpen}"
		       PointerPressed="OnOverlayPressed">

			<Border Width="400"
			       HorizontalAlignment="Left"
			       Background="{Binding CardBackground}"
			       BorderBrush="{Binding BorderColor}"
			       BorderThickness="0,0,1,0">

				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition Height="*" />
					</Grid.RowDefinitions>

					<!-- Menu Header -->
					<Border Grid.Row="0"
					       Background="{Binding WindowBackground}"
					       BorderBrush="{Binding BorderColor}"
					       BorderThickness="0,0,0,1"
					       Height="60">
						<Grid Margin="20,0">
							<TextBlock Text="{loc:Localize Settings}"
							          FontSize="14"
							          FontWeight="Bold"
							          Foreground="{Binding TextPrimary}"
							          VerticalAlignment="Center"
							          LetterSpacing="2" />

							<Button Classes="hamburger"
							       Command="{Binding ToggleMenuCommand}"
							       HorizontalAlignment="Right"
							       VerticalAlignment="Center"
							       ToolTip.Tip="Close">
								<TextBlock Text="✕" FontSize="18" Foreground="{Binding TextPrimary}" />
							</Button>
						</Grid>
					</Border>

					<!-- Menu Content -->
					<ScrollViewer Grid.Row="1" Padding="30,30">
						<StackPanel Spacing="32">

							<!-- Language Section -->
							<StackPanel Spacing="12">
								<TextBlock Text="{loc:Localize Language}"
										  FontSize="11"
										  FontWeight="Bold"
										  Foreground="{Binding TextPrimary}"
										  LetterSpacing="1" />

								<TextBlock Text="{loc:Localize LanguageDesc}"
										  FontSize="11"
										  Foreground="{Binding TextSecondary}"
										  TextWrapping="Wrap" />

								<ComboBox ItemsSource="{Binding AvailableLanguages}"
										 SelectedItem="{Binding SelectedLanguageOption}"
										 Background="{Binding InputBackground}"
										 Foreground="{Binding TextPrimary}"
										 BorderBrush="{Binding BorderColor}">
									<ComboBox.ItemTemplate>
										<DataTemplate>
											<TextBlock Text="{Binding Name}" />
										</DataTemplate>
									</ComboBox.ItemTemplate>
								</ComboBox>
							</StackPanel>

							<Border Background="{Binding BorderColor}" Height="1" />

							<!-- Launcher Arguments Section -->
							<StackPanel Spacing="12">
								<TextBlock Text="{loc:Localize LauncherArguments}"
								          FontSize="11"
								          FontWeight="Bold"
								          Foreground="{Binding TextPrimary}"
								          LetterSpacing="1" />

								<TextBlock Text="{loc:Localize LauncherArgumentsDesc}"
								          FontSize="11"
								          Foreground="{Binding TextSecondary}"
								          TextWrapping="Wrap" />

								<TextBox Text="{Binding LauncherArguments}"
								        Background="{Binding InputBackground}"
								        Foreground="{Binding TextPrimary}"
								        BorderBrush="{Binding BorderColor}"
								        BorderThickness="1"
								        Padding="12,10"
								        Watermark="e.g., -SkipIntro -Windowed" />
							</StackPanel>

							<Border Background="{Binding BorderColor}" Height="1" />

							<!-- Installation Path Section -->
							<StackPanel Spacing="12">
								<TextBlock Text="{loc:Localize InstallationPath}"
								          FontSize="11"
								          FontWeight="Bold"
								          Foreground="{Binding TextPrimary}"
								          LetterSpacing="1" />

								<TextBlock Text="{Binding InstallationPath}"
								          FontSize="11"
								          Foreground="{Binding TextSecondary}"
								          TextWrapping="Wrap" />

								<Button Classes="secondary"
								       Content="{loc:Localize ChangePath}"
								       Command="{Binding ChangePathCommand}"
								       Foreground="{Binding TextPrimary}"
								       HorizontalAlignment="Left" />
							</StackPanel>

							<Border Background="{Binding BorderColor}" Height="1" />

							<!-- About Section -->
							<StackPanel Spacing="12">
								<TextBlock Text="{loc:Localize About}"
								          FontSize="11"
								          FontWeight="Bold"
								          Foreground="{Binding TextPrimary}"
								          LetterSpacing="1" />

								<StackPanel Spacing="8">
									<Grid>
										<TextBlock Text="{loc:Localize LauncherVersion}"
										          FontSize="10"
										          Foreground="{Binding TextSecondary}"
										          HorizontalAlignment="Left" />
										<TextBlock Text="{Binding CurrentVersion}"
										          FontSize="10"
										          Foreground="{Binding TextPrimary}"
										          FontWeight="SemiBold"
										          HorizontalAlignment="Right" />
									</Grid>

									<Grid>
										<TextBlock Text="{loc:Localize ObsidianVersion}"
										          FontSize="10"
										          Foreground="{Binding TextSecondary}"
										          HorizontalAlignment="Left" />
										<TextBlock Text="{Binding ObsidianVersion}"
										          FontSize="10"
										          Foreground="{Binding TextPrimary}"
										          FontWeight="SemiBold"
										          HorizontalAlignment="Right" />
									</Grid>
								</StackPanel>

								<Button Classes="secondary"
								       Content="{loc:Localize CheckForUpdates}"
								       Command="{Binding CheckUpdatesCommand}"
								       Foreground="{Binding TextPrimary}"
								       HorizontalAlignment="Left"
								       Margin="0,8,0,0" />
							</StackPanel>
						</StackPanel>
					</ScrollViewer>
				</Grid>
			</Border>
		</Border>
	</Grid>
</Window>